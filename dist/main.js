(()=>{"use strict";class e{constructor(e){this.projectName=e,this.task=[]}addTask(e){this.task.push(e)}displayTask(e){console.log(this.task[e-1])}getDescription(){return this.task.map((e=>e.description))}getPrio(){return this.task.map((e=>e.priority))}getDueDate(){return this.task.map((e=>e.dueDate))}getID(){return console.log(this.task.map((e=>e.id)))}}function t(){const e=localStorage.getItem("Projects");return e?JSON.parse(e):[]}function o(e){const t=JSON.parse(localStorage.getItem("Projects"))||[];console.log(JSON.stringify(t)),console.log(t.length);for(let o=0;o<t.length;o++)t[o].projectName===e.projectName&&(console.log("deleting this"),t.splice(o,1),localStorage.setItem("Projects",JSON.stringify(t)),console.log(t))}function n(e,t){const o=JSON.parse(localStorage.getItem("Projects"))||[];for(let n=0;n<o.length;n++)o[n].projectName===e.projectName&&(o[n].projectName=t,console.log(o[n].projectName),localStorage.setItem("Projects",JSON.stringify(o)))}function a(e,t){let o=JSON.parse(localStorage.getItem("Projects"))||[];for(let n=0;n<o.length;n++)if(o[n].projectName===t.projectName){const t=o[n].task.findIndex((t=>t.description===e.description));-1!==t?(o[n].task.splice(t,1),console.log("Updated tasks:",o[n].task)):console.log("Task not found:",e)}else console.log("No match for:",t.projectName);localStorage.setItem("Projects",JSON.stringify(o))}function s(e,t,o){let n=JSON.parse(localStorage.getItem("Projects"))||[];for(let a=0;a<n.length;a++)if(n[a].projectName===t.projectName)for(let t=0;t<n[a].task.length;t++)n[a].task[t].description===e.description&&(console.log("match"),n[a].task[t].description=o,localStorage.setItem("Projects",JSON.stringify(n)))}function c(e,t,o,n){let a=JSON.parse(localStorage.getItem("Projects"))||[];for(let s=0;s<a.length;s++)if(a[s].projectName===t.projectName)for(let t=0;t<a[s].task.length;t++)console.log("matching this task and this task"),console.log(a[s].task[t]),console.log(e),a[s].task[t].description===e.description&&(console.log("match"),a[s].task[t].completed=o,localStorage.setItem("Projects",JSON.stringify(a)),console.log("task div"),console.log(n),!0===o&&(console.log("true adding"),n.classList.add("complete")),!1===o&&(console.log("false removing"),n.classList.remove("complete")))}function i(e,o,n,a){t();const s=document.createElement("button");return s.innerHTML="Mark as complete",s.addEventListener("click",(()=>{for(let t=0;t<e.task.length;t++)if(e.task[t].id==o){if(1==e.task[t].completed){const o=!1;c(e.task[t],e,o,n),e.task[t].completed=!1,n.classList.remove("complete");break}if(0==e.task[t].completed){const o=!0;c(e.task[t],e,o,n),e.task[t].completed=!0,n.classList.add("complete");break}}})),s}function l(e,t,o,n){const s=document.createElement("button");return s.classList.add("deleteTask"),s.innerHTML="Delete Task",s.addEventListener("click",(()=>{for(let n=0;n<e.task.length;n++)e.task[n].id==t&&(a(e.task[n],e),e.task.splice(n,1),o.innerHTML=`Task name: ${e.getDescription()[n]},\n                 priority: ${e.getPrio()[n]},\n                 it is due till ${e.getDueDate()[n]}`);n.removeChild(o)})),s}function r(e,t,o,n,a){const c=document.createElement("button");return c.innerHTML="Edit Name",c.addEventListener("click",(()=>{let c=prompt("New Task name:");for(let n=0;n<e.task.length;n++)e.task[n].id==t&&(s(e.task[n],e,c),e.task[n].description=c,o.innerHTML=`Task name: ${e.getDescription()[n]},\n                 priority: ${e.getPrio()[n]},\n                 it is due till ${e.getDueDate()[n]}`);console.log(e),o.appendChild(i(e,t,o)),o.appendChild(l(e,t,o,a)),o.appendChild(r(e,t,o,n,a))})),c}function d(e){let t=0,o=0;const n=document.createElement("div"),a=document.createElement("input");a.setAttribute("type","text"),a.setAttribute("name","setProperty"),a.setAttribute("id","setProperty");const s=document.createElement("label");s.setAttribute("for","setProperty"),s.innerHTML="Task Name:",n.classList.add("taskDiv");const c=document.createElement("select");c.setAttribute("name","setPrio"),c.setAttribute("id","setPrio");const d=document.createElement("option");d.setAttribute("value","high");const p=document.createTextNode("High"),m=document.createElement("option");m.setAttribute("value","medium");const u=document.createTextNode("Medium"),g=document.createElement("option");g.setAttribute("value","low");const h=document.createTextNode("Low");d.appendChild(p),m.appendChild(u),g.appendChild(h),c.appendChild(d),c.appendChild(m),c.appendChild(g);const k=document.createElement("label");k.setAttribute("for","setPrio"),k.innerHTML="Add Priority";const f=document.createElement("input");f.setAttribute("type","date"),f.setAttribute("name","taskDueDate"),f.setAttribute("id","taskDueDate"),f.setAttribute("required","");const j=document.createElement("label");j.setAttribute("for","taskDueDate"),j.innerHTML="Due: ";const N=document.createElement("button");N.innerHTML="add";const E=document.createElement("div");return E.classList.add("taskOptions"),console.log("in tasks"),console.log(e),N.addEventListener("click",(()=>{const s=a.value,d=c.value,p=f.value;if(""==s||""==d||""==p)return alert("Fill out all the fields");e.addTask({description:s,priority:d,dueDate:p,completed:false,id:t++}),o++,function(e,t){let o=JSON.parse(localStorage.getItem("Projects"))||[];for(let n=0;n<o.length;n++)o[n].projectName===t.projectName?o[n].task=e:console.log("we dont match");localStorage.setItem("Projects",JSON.stringify(o))}(e.task,e);const m=document.createElement("div");m.classList.add("currentTasks"),m.setAttribute("data-id",o-1),a.value="",console.log(e);const u=m.dataset.id;console.log(u+"for currenttaskDiv"),m.innerHTML=`Task name: ${e.getDescription()[e.task.length-1]},\n             priority: ${e.getPrio()[e.task.length-1]},\n             it is due till ${e.getDueDate()[e.task.length-1]}`;const g=i(e,u,m),h=l(e,u,m,n),k=r(e,u,m,false,n);n.appendChild(m),m.appendChild(g),m.appendChild(k),m.appendChild(h)})),E.appendChild(s),E.appendChild(a),E.appendChild(k),E.appendChild(c),E.appendChild(j),E.appendChild(f),E.appendChild(N),n.appendChild(E),n}function p(e){let t=JSON.parse(localStorage.getItem("Projects"))||[];if(t.length>0){for(let o=0;o<t.length;o++)if(t[o].projectName===e)return e;return t[t.length-1].projectName}return e}const m=document.getElementById("content"),u=document.getElementById("projectName"),g=document.getElementById("submit");window.onload=function(){const a=t();!function(e){const o=t();0===o.length&&(o.push(e),localStorage.setItem("Projects",JSON.stringify(o)))}(new e("Default")),a.forEach((t=>{const a=new e(t.projectName);t.task.forEach((e=>{a.addTask({description:e.description,priority:e.priority,dueDate:e.dueDate,completed:e.completed,id:e.id+100})})),console.log("after tasks"),console.log(a),function(e){console.log("here"),console.log(e);const t=document.createElement("div");t.setAttribute("id","projectNameDiv");const a=document.createElement("div");a.setAttribute("id","projectHeadline");const s=document.createElement("h3");s.innerHTML=`Project name: ${p(e.projectName)}`;const c=d(e),u=document.createElement("button");u.innerHTML="Delete Project";const g=document.createElement("button");g.innerHTML="Edit Project",t.appendChild(a),a.appendChild(s),a.appendChild(u),a.appendChild(g),t.appendChild(c),e.task.forEach((t=>{const o=document.createElement("div");o.classList.add("currentTasks"),o.setAttribute("data-id",t.id);const n=o.dataset.id,a=t.completed;!0===a&&(console.log("yea this is done"),o.classList.add("complete")),o.innerHTML=`\n            Task name: ${t.description},\n            priority: ${t.priority},\n            it is due till ${t.dueDate}`;const s=i(e,n,o),d=l(e,n,o,c),p=r(e,n,o,a,c);c.appendChild(o),o.appendChild(s),o.appendChild(p),o.appendChild(d)})),u.addEventListener("click",(()=>{m.removeChild(t),o(e)})),g.addEventListener("click",(()=>{let t=prompt("Enter new project name:");n(e,t),s.innerHTML=`Project name: ${p(t)}`})),m.appendChild(t)}(a)}))},g.addEventListener("click",(()=>{const t=document.createElement("div");t.setAttribute("id","projectNameDiv");const a=document.createElement("div");a.setAttribute("id","projectHeadline");const s=document.createElement("h3");let c=u.value,i=new e(c);!1===function(e){let t=JSON.parse(localStorage.getItem("Projects"))||[];return t.find((t=>t.projectName===e.projectName))?(alert("Names are the same"),!0):(t.push(e),localStorage.setItem("Projects",JSON.stringify(t)),console.log("Project added successfully"),!1)}(i)&&(m.appendChild(t),JSON.parse(localStorage.getItem("Projects"))),s.innerHTML="Project name: "+p(c);const l=d(i),r=document.createElement("button");r.innerHTML="Delete Project";const g=document.createElement("button");g.innerHTML="Edit Project",t.appendChild(a),a.appendChild(s),a.appendChild(r),a.appendChild(g),t.appendChild(l),r.addEventListener("click",(()=>{m.removeChild(t),o(i)})),g.addEventListener("click",(()=>{let e=prompt("enter new project name:");n(i,e),console.log(e),c=e,i.projectName=c,s.innerHTML=`Project name is: ${c}`,s.appendChild(r),s.appendChild(g)})),u.value="",console.log(i)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RyxHQUN0Qi9GLGFBQWFXLFFBQVEsV0FBWVQsS0FBS0ssVUFBVUQsSUFDaERuQixRQUFRQyxJQUFJLCtCQUNMLEVBRWYsQ0lZTzhHLENBQWFuRSxLQUNaK0MsRUFBUS9CLFlBQVkwQyxHQUNHdkYsS0FBS0MsTUFBTUgsYUFBYUMsUUFBUSxjQUczRDBGLEVBQVV0RCxVQUFZLGlCQUFtQnVDLEVBQTBCQyxHQUVuRSxNQUFNckMsRUFBVVEsRUFBV2pCLEdBRXJCNkQsRUFBbUJ6RCxTQUFTQyxjQUFjLFVBQ2hEd0QsRUFBaUJ2RCxVQUFZLGlCQUU3QixNQUFNd0QsRUFBaUIxRCxTQUFTQyxjQUFjLFVBQzlDeUQsRUFBZXhELFVBQVksZUFFM0JvRCxFQUFlMUMsWUFBWTJDLEdBQzNCQSxFQUFtQjNDLFlBQVk0QyxHQUMvQkQsRUFBbUIzQyxZQUFZNkMsR0FDL0JGLEVBQW1CM0MsWUFBWThDLEdBQy9CSixFQUFlMUMsWUFBWVAsR0FFM0JvRCxFQUFpQnRELGlCQUFpQixTQUFRLEtBQ3RDd0MsRUFBUXBDLFlBQVkrQyxHQUNwQnJGLEVBQWMyQixFQUFnQixJQUdsQzhELEVBQWV2RCxpQkFBaUIsU0FBUyxLQUNyQyxJQUFJeEIsRUFBWWdDLE9BQU8sMkJBQ3ZCbEMsRUFBa0JtQixFQUFrQmpCLEdBQ3BDM0IsUUFBUUMsSUFBSTBCLEdBQ1orRCxFQUFZL0QsRUFDWmlCLEVBQWlCcEQsWUFBY2tHLEVBRS9CYyxFQUFVdEQsVUFBWSxvQkFBb0J3QyxJQUMxQ2MsRUFBVTVDLFlBQVk2QyxHQUN0QkQsRUFBVTVDLFlBQVk4QyxFQUFlLElBRXpDYixFQUFnQnhELE1BQVEsR0FDeEJyQyxRQUFRQyxJQUFJMkMsRUFBaUIsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3RvZG8tdG9wLy4vc3JjL2NvbnN0cnVjdG9yLmpzIiwid2VicGFjazovL3RvZG8tdG9wLy4vc3JjL3N0b3JhZ2UuanMiLCJ3ZWJwYWNrOi8vdG9kby10b3AvLi9zcmMvYnV0dG9ucy5qcyIsIndlYnBhY2s6Ly90b2RvLXRvcC8uL3NyYy90YXNrcy5qcyIsIndlYnBhY2s6Ly90b2RvLXRvcC8uL3NyYy9kaXNwbGF5LmpzIiwid2VicGFjazovL3RvZG8tdG9wLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBQcm9qZWN0IHtcbiAgICBjb25zdHJ1Y3Rvcihwcm9qZWN0TmFtZSl7XG4gICAgICAgIHRoaXMucHJvamVjdE5hbWUgPSBwcm9qZWN0TmFtZTtcbiAgICAgICAgdGhpcy50YXNrID0gW107XG4gICAgfVxuXG4gICAgYWRkVGFzayhuZXdUYXNrKXtcbiAgICAgICAgdGhpcy50YXNrLnB1c2gobmV3VGFzayk7XG4gICAgfVxuXG4gICAgZGlzcGxheVRhc2soaW5kZXgpe1xuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnRhc2tbaW5kZXgtMV0pXG4gICAgfVxuXG4gICAgZ2V0RGVzY3JpcHRpb24oKXtcbiAgICAgICAgcmV0dXJuIHRoaXMudGFzay5tYXAodGFzayA9PiB0YXNrLmRlc2NyaXB0aW9uKTsgXG4gICAgfVxuXG4gICAgZ2V0UHJpbygpe1xuICAgICAgICByZXR1cm4gdGhpcy50YXNrLm1hcCh0YXNrID0+IHRhc2sucHJpb3JpdHkpOyBcbiAgICB9XG5cbiAgICBnZXREdWVEYXRlKCl7XG4gICAgICAgIHJldHVybiB0aGlzLnRhc2subWFwKHRhc2sgPT4gdGFzay5kdWVEYXRlKTsgXG4gICAgfVxuXG4gICAgZ2V0SUQoKXtcbiAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKHRoaXMudGFzay5tYXAodGFzayA9PiB0YXNrLmlkKSk7XG59XG59IiwiZXhwb3J0IGZ1bmN0aW9uIGdldFByb2plY3RzRnJvbVN0b3JhZ2UoKSB7XG4gICAgY29uc3Qgc3RvcmVkUHJvamVjdHMgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIlByb2plY3RzXCIpO1xuICAgIHJldHVybiBzdG9yZWRQcm9qZWN0cyA/IEpTT04ucGFyc2Uoc3RvcmVkUHJvamVjdHMpIDogW107XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXREZWZhdWx0UHJvamVjdChkZWZhdWx0UHJvamVjdCl7XG4gICAgY29uc3Qgc3RvcmVkUHJvamVjdHMgPSBnZXRQcm9qZWN0c0Zyb21TdG9yYWdlKCk7XG5cbiAgIGlmKHN0b3JlZFByb2plY3RzLmxlbmd0aCA9PT0gMCl7XG4gICAgc3RvcmVkUHJvamVjdHMucHVzaChkZWZhdWx0UHJvamVjdClcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIlByb2plY3RzXCIsIEpTT04uc3RyaW5naWZ5KHN0b3JlZFByb2plY3RzKSk7XG4gICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzdG9yZVByb2plY3QocHJvamVjdCkge1xuICAgIFxuICAgIGxldCBleGlzdGluZ1Byb2plY3RzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIlByb2plY3RzXCIpKSB8fCBbXTtcblxuICAgIC8vIENoZWNrIGlmIHRoZSBwcm9qZWN0IHdpdGggdGhlIHNhbWUgbmFtZSBhbHJlYWR5IGV4aXN0c1xuICAgIGNvbnN0IGV4aXN0aW5nUHJvamVjdCA9IGV4aXN0aW5nUHJvamVjdHMuZmluZCgocHJvamVjdE9iaikgPT4ge1xuICAgICAgICByZXR1cm4gcHJvamVjdE9iai5wcm9qZWN0TmFtZSA9PT0gcHJvamVjdC5wcm9qZWN0TmFtZTtcbiAgICB9KTtcblxuICAgIGlmIChleGlzdGluZ1Byb2plY3QpIHtcbiAgICAgICAgLy8gSWYgYSBwcm9qZWN0IHdpdGggdGhlIHNhbWUgbmFtZSBleGlzdHMsIHNob3cgYW4gYWxlcnQgYW5kIHJldHVyblxuICAgICAgICBhbGVydChcIk5hbWVzIGFyZSB0aGUgc2FtZVwiKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gSWYgbm8gcHJvamVjdCB3aXRoIHRoZSBzYW1lIG5hbWUgZXhpc3RzLCBhZGQgdGhlIG5ldyBwcm9qZWN0XG4gICAgICAgIGV4aXN0aW5nUHJvamVjdHMucHVzaChwcm9qZWN0KTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJQcm9qZWN0c1wiLCBKU09OLnN0cmluZ2lmeShleGlzdGluZ1Byb2plY3RzKSk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiUHJvamVjdCBhZGRlZCBzdWNjZXNzZnVsbHlcIik7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWxldGVQcm9qZWN0KHByb2plY3RUb0RlbGV0ZSkge1xuXG4gICAgY29uc3QgZXhpc3RpbmdQcm9qZWN0cyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJQcm9qZWN0c1wiKSkgfHwgW107XG4gICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZXhpc3RpbmdQcm9qZWN0cykpO1xuICAgIGNvbnNvbGUubG9nKGV4aXN0aW5nUHJvamVjdHMubGVuZ3RoKVxuXG4gICAgIGZvcihsZXQgaSA9IDA7IGkgPCBleGlzdGluZ1Byb2plY3RzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgIGlmKGV4aXN0aW5nUHJvamVjdHNbaV0ucHJvamVjdE5hbWU9PT1wcm9qZWN0VG9EZWxldGUucHJvamVjdE5hbWUpe1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJkZWxldGluZyB0aGlzXCIpXG4gICAgICAgICAgICBleGlzdGluZ1Byb2plY3RzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiUHJvamVjdHNcIiwgSlNPTi5zdHJpbmdpZnkoZXhpc3RpbmdQcm9qZWN0cykpXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhleGlzdGluZ1Byb2plY3RzKVxuICAgICAgICAgfVxuICAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVQcm9qZWN0TmFtZShwcm9qZWN0VG9FZGl0LCBuZXdOYW1lSXMpe1xuICAgIGNvbnN0IGV4aXN0aW5nUHJvamVjdHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiUHJvamVjdHNcIikpIHx8IFtdO1xuXG4gICAgZm9yKGxldCBpID0gMDsgaSA8IGV4aXN0aW5nUHJvamVjdHMubGVuZ3RoOyBpKyspe1xuICAgICAgICBpZihleGlzdGluZ1Byb2plY3RzW2ldLnByb2plY3ROYW1lPT09cHJvamVjdFRvRWRpdC5wcm9qZWN0TmFtZSl7XG4gICAgICAgICAgICBleGlzdGluZ1Byb2plY3RzW2ldLnByb2plY3ROYW1lID0gbmV3TmFtZUlzO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXhpc3RpbmdQcm9qZWN0c1tpXS5wcm9qZWN0TmFtZSlcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiUHJvamVjdHNcIiwgSlNPTi5zdHJpbmdpZnkoZXhpc3RpbmdQcm9qZWN0cykpXG5cbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHN0b3JlVGFza3Moc3RvcmVUYXNrLCBwcm9qZWN0TmFtZSl7XG4gICAgbGV0IGV4aXN0aW5nUHJvamVjdHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiUHJvamVjdHNcIikpIHx8IFtdO1xuXG4gICAgIGZvcihsZXQgaSA9IDA7IGkgPCBleGlzdGluZ1Byb2plY3RzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgIGlmKGV4aXN0aW5nUHJvamVjdHNbaV0ucHJvamVjdE5hbWUgPT09IHByb2plY3ROYW1lLnByb2plY3ROYW1lKXtcbiAgICAgICAgICAgIGV4aXN0aW5nUHJvamVjdHNbaV0udGFzayA9IHN0b3JlVGFzaztcbiAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwid2UgZG9udCBtYXRjaFwiKVxuICAgICAgICAgfVxuICAgICB9XG4gICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiUHJvamVjdHNcIiwgSlNPTi5zdHJpbmdpZnkoZXhpc3RpbmdQcm9qZWN0cykpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVsZXRlVGFzayh0YXNrVG9EZWxldGUsIHByb2plY3ROYW1lKSB7XG4gICAgbGV0IGV4aXN0aW5nUHJvamVjdHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiUHJvamVjdHNcIikpIHx8IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBleGlzdGluZ1Byb2plY3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChleGlzdGluZ1Byb2plY3RzW2ldLnByb2plY3ROYW1lID09PSBwcm9qZWN0TmFtZS5wcm9qZWN0TmFtZSkge1xuXG4gICAgICAgICAgICBjb25zdCBpbmRleFRvRGVsZXRlID0gZXhpc3RpbmdQcm9qZWN0c1tpXS50YXNrLmZpbmRJbmRleCh0YXNrID0+IHRhc2suZGVzY3JpcHRpb24gPT09IHRhc2tUb0RlbGV0ZS5kZXNjcmlwdGlvbik7XG5cbiAgICAgICAgICAgIC8vIElmIHRoZSB0YXNrIGlzIGZvdW5kLCByZW1vdmUgaXQgZnJvbSB0aGUgJ3Rhc2snIGFycmF5XG4gICAgICAgICAgICBpZiAoaW5kZXhUb0RlbGV0ZSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBleGlzdGluZ1Byb2plY3RzW2ldLnRhc2suc3BsaWNlKGluZGV4VG9EZWxldGUsIDEpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVXBkYXRlZCB0YXNrczpcIiwgZXhpc3RpbmdQcm9qZWN0c1tpXS50YXNrKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUYXNrIG5vdCBmb3VuZDpcIiwgdGFza1RvRGVsZXRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTm8gbWF0Y2ggZm9yOlwiLCBwcm9qZWN0TmFtZS5wcm9qZWN0TmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gVXBkYXRlIGxvY2FsIHN0b3JhZ2Ugd2l0aCB0aGUgbW9kaWZpZWQgYXJyYXlcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIlByb2plY3RzXCIsIEpTT04uc3RyaW5naWZ5KGV4aXN0aW5nUHJvamVjdHMpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVRhc2tOYW1lKHRhc2tUb1VwZGF0ZSwgcHJvamVjdE5hbWUsIG5ld05hbWUpe1xuICAgIGxldCBleGlzdGluZ1Byb2plY3RzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIlByb2plY3RzXCIpKSB8fCBbXTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZXhpc3RpbmdQcm9qZWN0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoZXhpc3RpbmdQcm9qZWN0c1tpXS5wcm9qZWN0TmFtZSA9PT0gcHJvamVjdE5hbWUucHJvamVjdE5hbWUpIHtcbiAgICAgICAgICAgIC8vcnVuIGZvciBsb29wIG9uIGV4aXN0aW5nUHJvamVjdHNbaV0udGFzayBhbmQgbWF0Y2ggaXQgYWdhaW5zIHRhc2tUb1VwZGF0ZVxuICAgICAgICAgICAgZm9yKGxldCBqID0gMDsgaiA8IGV4aXN0aW5nUHJvamVjdHNbaV0udGFzay5sZW5ndGg7IGorKyl7XG4gICAgICAgICAgICAgICAgaWYoZXhpc3RpbmdQcm9qZWN0c1tpXS50YXNrW2pdLmRlc2NyaXB0aW9uID09PSB0YXNrVG9VcGRhdGUuZGVzY3JpcHRpb24pe1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm1hdGNoXCIpO1xuICAgICAgICAgICAgICAgICAgICBleGlzdGluZ1Byb2plY3RzW2ldLnRhc2tbal0uZGVzY3JpcHRpb24gPSBuZXdOYW1lO1xuICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIlByb2plY3RzXCIsIEpTT04uc3RyaW5naWZ5KGV4aXN0aW5nUHJvamVjdHMpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYXJrQXNDb21wbGV0ZWQodGFza1RvVXBkYXRlLCBwcm9qZWN0TmFtZSwgdmFsdWUsIGN1cnJlbnRUYXNrc0Rpdil7XG4gICAgbGV0IGV4aXN0aW5nUHJvamVjdHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiUHJvamVjdHNcIikpIHx8IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBleGlzdGluZ1Byb2plY3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChleGlzdGluZ1Byb2plY3RzW2ldLnByb2plY3ROYW1lID09PSBwcm9qZWN0TmFtZS5wcm9qZWN0TmFtZSkge1xuICAgICAgICAgICAgLy9ydW4gZm9yIGxvb3Agb24gZXhpc3RpbmdQcm9qZWN0c1tpXS50YXNrIGFuZCBtYXRjaCBpdCBhZ2FpbnMgdGFza1RvVXBkYXRlXG4gICAgICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgZXhpc3RpbmdQcm9qZWN0c1tpXS50YXNrLmxlbmd0aDsgaisrKXtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIm1hdGNoaW5nIHRoaXMgdGFzayBhbmQgdGhpcyB0YXNrXCIpXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXhpc3RpbmdQcm9qZWN0c1tpXS50YXNrW2pdKVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRhc2tUb1VwZGF0ZSlcbiAgICAgICAgICAgICAgICBpZihleGlzdGluZ1Byb2plY3RzW2ldLnRhc2tbal0uZGVzY3JpcHRpb24gPT09IHRhc2tUb1VwZGF0ZS5kZXNjcmlwdGlvbil7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibWF0Y2hcIik7XG4gICAgICAgICAgICAgICAgICAgIGV4aXN0aW5nUHJvamVjdHNbaV0udGFza1tqXS5jb21wbGV0ZWQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJQcm9qZWN0c1wiLCBKU09OLnN0cmluZ2lmeShleGlzdGluZ1Byb2plY3RzKSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidGFzayBkaXZcIilcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coY3VycmVudFRhc2tzRGl2KVxuICAgICAgICAgICAgICAgICAgICAgaWYodmFsdWUgPT09IHRydWUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ0cnVlIGFkZGluZ1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRUYXNrc0Rpdi5jbGFzc0xpc3QuYWRkKFwiY29tcGxldGVcIilcbiAgICAgICAgICAgICAgICAgICAgIH1pZih2YWx1ZSA9PT0gZmFsc2Upe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJmYWxzZSByZW1vdmluZ1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRUYXNrc0Rpdi5jbGFzc0xpc3QucmVtb3ZlKFwiY29tcGxldGVcIilcbiAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cblxuIiwiIGltcG9ydCB7IGRlbGV0ZVRhc2ssIHVwZGF0ZVRhc2tOYW1lIH0gZnJvbSBcIi4vc3RvcmFnZVwiO1xuIGltcG9ydCB7IGdldFByb2plY3RzRnJvbVN0b3JhZ2UsIG1hcmtBc0NvbXBsZXRlZCB9IGZyb20gXCIuL3N0b3JhZ2VcIjtcbiBcbiBleHBvcnQgZnVuY3Rpb24gYWRkQ29tcGxldGVCdXR0b24oY3JlYXRlTmV3UHJvamVjdCxnZXRUYXNrRGl2SWQsIGN1cnJlbnRUYXNrc0RpdiwgaXNUYXNrQ29tcGxldGVkKXtcbiAgICBjb25zdCBwdWxsUHJvamVjdHMgPSBnZXRQcm9qZWN0c0Zyb21TdG9yYWdlKCk7XG5cbiAgICBjb25zdCBjb21wbGV0ZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgY29tcGxldGVCdXR0b24uaW5uZXJIVE1MPSBcIk1hcmsgYXMgY29tcGxldGVcIjtcblxuICAgICBjb21wbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCApPT57XG4gICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNyZWF0ZU5ld1Byb2plY3QudGFzay5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICAgaWYoY3JlYXRlTmV3UHJvamVjdC50YXNrW2ldLmlkID09IGdldFRhc2tEaXZJZCl7IFxuICAgICAgICAgICAgICAgICBpZihjcmVhdGVOZXdQcm9qZWN0LnRhc2tbaV0uY29tcGxldGVkID09IHRydWUpe1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgbWFya0FzQ29tcGxldGVkKGNyZWF0ZU5ld1Byb2plY3QudGFza1tpXSxjcmVhdGVOZXdQcm9qZWN0LCB2YWx1ZSwgY3VycmVudFRhc2tzRGl2KVxuICAgICAgICAgICAgICAgICAgICAgY3JlYXRlTmV3UHJvamVjdC50YXNrW2ldLmNvbXBsZXRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgY3VycmVudFRhc2tzRGl2LmNsYXNzTGlzdC5yZW1vdmUoXCJjb21wbGV0ZVwiKVxuICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgIH1pZihjcmVhdGVOZXdQcm9qZWN0LnRhc2tbaV0uY29tcGxldGVkID09IGZhbHNlKXtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgbWFya0FzQ29tcGxldGVkKGNyZWF0ZU5ld1Byb2plY3QudGFza1tpXSxjcmVhdGVOZXdQcm9qZWN0LCB2YWx1ZSwgY3VycmVudFRhc2tzRGl2IClcbiAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZU5ld1Byb2plY3QudGFza1tpXS5jb21wbGV0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgY3VycmVudFRhc2tzRGl2LmNsYXNzTGlzdC5hZGQoXCJjb21wbGV0ZVwiKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgfSlcbiAgICAgcmV0dXJuKGNvbXBsZXRlQnV0dG9uKTtcblxufVxuXG5leHBvcnQgZnVuY3Rpb24gYWRkRGVsZXRlQnV0dG9uIChjcmVhdGVOZXdQcm9qZWN0LCBnZXRUYXNrRGl2SWQsIGN1cnJlbnRUYXNrc0RpdiwgdGFza0Rpdil7XG4gICAgY29uc3QgZGVsZXRlVGFza0J1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgZGVsZXRlVGFza0J1dHRvbi5jbGFzc0xpc3QuYWRkKFwiZGVsZXRlVGFza1wiKTtcbiAgICBkZWxldGVUYXNrQnV0dG9uLmlubmVySFRNTCA9IFwiRGVsZXRlIFRhc2tcIjtcblxuICAgIGRlbGV0ZVRhc2tCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpPT57XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY3JlYXRlTmV3UHJvamVjdC50YXNrLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgIGlmKGNyZWF0ZU5ld1Byb2plY3QudGFza1tpXS5pZCA9PSBnZXRUYXNrRGl2SWQpe1xuICAgICAgICAgICAgICAgIGRlbGV0ZVRhc2soY3JlYXRlTmV3UHJvamVjdC50YXNrW2ldLCBjcmVhdGVOZXdQcm9qZWN0KVxuICAgICAgICAgICAgICAgIGNyZWF0ZU5ld1Byb2plY3QudGFzay5zcGxpY2UoaSwxKTsgIFxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGN1cnJlbnRUYXNrc0Rpdi5pbm5lckhUTUwgPSBcbiAgICAgICAgICAgICAgICBgVGFzayBuYW1lOiAke2NyZWF0ZU5ld1Byb2plY3QuZ2V0RGVzY3JpcHRpb24oKVtpXX0sXG4gICAgICAgICAgICAgICAgIHByaW9yaXR5OiAke2NyZWF0ZU5ld1Byb2plY3QuZ2V0UHJpbygpW2ldfSxcbiAgICAgICAgICAgICAgICAgaXQgaXMgZHVlIHRpbGwgJHtjcmVhdGVOZXdQcm9qZWN0LmdldER1ZURhdGUoKVtpXX1gO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRhc2tEaXYucmVtb3ZlQ2hpbGQoY3VycmVudFRhc2tzRGl2KTtcbiAgICB9KTtcblxuICAgIHJldHVybiBkZWxldGVUYXNrQnV0dG9uO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYWRkRWRpdEJ1dHRvbihjcmVhdGVOZXdQcm9qZWN0LCBnZXRUYXNrRGl2SWQsIGN1cnJlbnRUYXNrc0RpdiwgaXNUYXNrQ29tcGxldGVkLCB0YXNrRGl2KXtcbiAgICBjb25zdCBlZGl0VGFza0J1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgZWRpdFRhc2tCdXR0b24uaW5uZXJIVE1MID0gXCJFZGl0IE5hbWVcIjtcblxuICAgIGVkaXRUYXNrQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKT0+e1xuICAgICAgICBsZXQgZWRpdFRhc2tOYW1lID0gcHJvbXB0KFwiTmV3IFRhc2sgbmFtZTpcIik7XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjcmVhdGVOZXdQcm9qZWN0LnRhc2subGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgaWYoY3JlYXRlTmV3UHJvamVjdC50YXNrW2ldLmlkID09IGdldFRhc2tEaXZJZCl7XG4gICAgICAgICAgICAgICAgdXBkYXRlVGFza05hbWUoY3JlYXRlTmV3UHJvamVjdC50YXNrW2ldLGNyZWF0ZU5ld1Byb2plY3QsZWRpdFRhc2tOYW1lKTtcbiAgICAgICAgICAgICAgICBjcmVhdGVOZXdQcm9qZWN0LnRhc2tbaV0uZGVzY3JpcHRpb24gPSBlZGl0VGFza05hbWU7XG5cbiAgICAgICAgICAgICAgICBjdXJyZW50VGFza3NEaXYuaW5uZXJIVE1MID0gXG4gICAgICAgICAgICAgICAgYFRhc2sgbmFtZTogJHtjcmVhdGVOZXdQcm9qZWN0LmdldERlc2NyaXB0aW9uKClbaV19LFxuICAgICAgICAgICAgICAgICBwcmlvcml0eTogJHtjcmVhdGVOZXdQcm9qZWN0LmdldFByaW8oKVtpXX0sXG4gICAgICAgICAgICAgICAgIGl0IGlzIGR1ZSB0aWxsICR7Y3JlYXRlTmV3UHJvamVjdC5nZXREdWVEYXRlKClbaV19YDsgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuXG4gICAgY29uc29sZS5sb2coY3JlYXRlTmV3UHJvamVjdCk7XG4gICAgY3VycmVudFRhc2tzRGl2LmFwcGVuZENoaWxkKGFkZENvbXBsZXRlQnV0dG9uKGNyZWF0ZU5ld1Byb2plY3QsIGdldFRhc2tEaXZJZCwgY3VycmVudFRhc2tzRGl2LCBpc1Rhc2tDb21wbGV0ZWQpKTtcbiAgICBjdXJyZW50VGFza3NEaXYuYXBwZW5kQ2hpbGQoYWRkRGVsZXRlQnV0dG9uKGNyZWF0ZU5ld1Byb2plY3QsIGdldFRhc2tEaXZJZCwgY3VycmVudFRhc2tzRGl2LCB0YXNrRGl2KSk7XG4gICAgY3VycmVudFRhc2tzRGl2LmFwcGVuZENoaWxkKGFkZEVkaXRCdXR0b24oY3JlYXRlTmV3UHJvamVjdCwgZ2V0VGFza0RpdklkLCBjdXJyZW50VGFza3NEaXYsIGlzVGFza0NvbXBsZXRlZCwgdGFza0RpdikpOyAgXG4gICAgXG4gICAgfSk7XG4gICAgcmV0dXJuIGVkaXRUYXNrQnV0dG9uO1xufVxuXG4iLCJpbXBvcnQgeyBzdG9yZVRhc2tzLCBkZWxldGVUYXNrLCB1cGRhdGVUYXNrTmFtZSB9IGZyb20gXCIuL3N0b3JhZ2VcIjtcbmltcG9ydCB7IGFkZENvbXBsZXRlQnV0dG9uLCBhZGREZWxldGVCdXR0b24sIGFkZEVkaXRCdXR0b24gfSBmcm9tIFwiLi9idXR0b25zXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUYXNrKGNyZWF0ZU5ld1Byb2plY3Qpe1xuICAgIGxldCBkYXRhQ291bnRlciA9IDA7XG4gICAgbGV0IHRhc2tDb3VudGVyID0gMDtcblxuICAgIGNvbnN0IHRhc2tEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIFxuICAgIC8vRE9NIGZvciBhZGRpbmcgVGFza3MgaW50byBQcm9qZWN0c1xuICAgIGNvbnN0IGFkZFRhc2tGb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xuICAgIGFkZFRhc2tGb3JtLnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJ0ZXh0XCIpO1xuICAgIGFkZFRhc2tGb3JtLnNldEF0dHJpYnV0ZShcIm5hbWVcIiwgXCJzZXRQcm9wZXJ0eVwiKTtcbiAgICBhZGRUYXNrRm9ybS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcInNldFByb3BlcnR5XCIpO1xuICAgIFxuICAgIGNvbnN0IGFkZExhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO1xuICAgIGFkZExhYmVsLnNldEF0dHJpYnV0ZShcImZvclwiLCBcInNldFByb3BlcnR5XCIpO1xuICAgIGFkZExhYmVsLmlubmVySFRNTCA9IFwiVGFzayBOYW1lOlwiO1xuICAgIFxuICAgIHRhc2tEaXYuY2xhc3NMaXN0LmFkZChcInRhc2tEaXZcIik7XG4gICAgXG4gICAgLy9ET00gZm9yIGFkZGluZyBwcmlvcml0eSBvbiBUYXNrc1xuICAgIGNvbnN0IGFkZFByaW9Gb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiKTsgIFxuICAgIGFkZFByaW9Gb3JtLnNldEF0dHJpYnV0ZShcIm5hbWVcIiwgXCJzZXRQcmlvXCIpO1xuICAgIGFkZFByaW9Gb3JtLnNldEF0dHJpYnV0ZShcImlkXCIsIFwic2V0UHJpb1wiKTtcbiAgICBcbiAgICBjb25zdCBvcHRpb25zSGlnaCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIik7XG4gICAgb3B0aW9uc0hpZ2guc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgXCJoaWdoXCIpO1xuICAgIGNvbnN0IG9wdGlvbnNUZXh0SGlnaCA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFwiSGlnaFwiKTtcbiAgICBcbiAgICBjb25zdCBvcHRpb25zTWVkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcbiAgICBvcHRpb25zTWVkLnNldEF0dHJpYnV0ZShcInZhbHVlXCIsIFwibWVkaXVtXCIpO1xuICAgIGNvbnN0IG9wdGlvbnNUZXh0TWVkID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCJNZWRpdW1cIik7XG4gICAgXG4gICAgY29uc3Qgb3B0aW9uc0xvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIik7XG4gICAgb3B0aW9uc0xvdy5zZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiLCBcImxvd1wiKTtcbiAgICBjb25zdCBvcHRpb25zVGV4dExvdyA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFwiTG93XCIpO1xuICAgIFxuICAgIG9wdGlvbnNIaWdoLmFwcGVuZENoaWxkKG9wdGlvbnNUZXh0SGlnaCk7XG4gICAgb3B0aW9uc01lZC5hcHBlbmRDaGlsZChvcHRpb25zVGV4dE1lZCk7XG4gICAgb3B0aW9uc0xvdy5hcHBlbmRDaGlsZChvcHRpb25zVGV4dExvdyk7XG4gICAgYWRkUHJpb0Zvcm0uYXBwZW5kQ2hpbGQob3B0aW9uc0hpZ2gpO1xuICAgIGFkZFByaW9Gb3JtLmFwcGVuZENoaWxkKG9wdGlvbnNNZWQpO1xuICAgIGFkZFByaW9Gb3JtLmFwcGVuZENoaWxkKG9wdGlvbnNMb3cpO1xuICAgIFxuICAgIGNvbnN0IGFkZExhYmVsUHJpbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtcbiAgICBhZGRMYWJlbFByaW8uc2V0QXR0cmlidXRlKFwiZm9yXCIsIFwic2V0UHJpb1wiKTtcbiAgICBhZGRMYWJlbFByaW8uaW5uZXJIVE1MID0gXCJBZGQgUHJpb3JpdHlcIjtcbiAgICBcbiAgICAvL0RPTSBmb3IgYWRkaW5nIGR1ZSBkYXRlIG9uIHRhc2tzXG4gICAgY29uc3QgYWRkVGFza0R1ZURhdGVGb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xuICAgIGFkZFRhc2tEdWVEYXRlRm9ybS5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwiZGF0ZVwiKTtcbiAgICBhZGRUYXNrRHVlRGF0ZUZvcm0uc2V0QXR0cmlidXRlKFwibmFtZVwiLCBcInRhc2tEdWVEYXRlXCIpO1xuICAgIGFkZFRhc2tEdWVEYXRlRm9ybS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcInRhc2tEdWVEYXRlXCIpO1xuICAgIGFkZFRhc2tEdWVEYXRlRm9ybS5zZXRBdHRyaWJ1dGUoXCJyZXF1aXJlZFwiLCBcIlwiKVxuICAgIFxuICAgIGNvbnN0IGFkZFRhc2tEdWVEYXRlTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XG4gICAgYWRkVGFza0R1ZURhdGVMYWJlbC5zZXRBdHRyaWJ1dGUoXCJmb3JcIiwgXCJ0YXNrRHVlRGF0ZVwiKTtcbiAgICBhZGRUYXNrRHVlRGF0ZUxhYmVsLmlubmVySFRNTCA9IFwiRHVlOiBcIjtcbiAgICBcbiAgICAvL0RPTSBmb3IgYWRkaW5nIGJ1dHRvbiB0byBhZGQgVGFza3NcbiAgICBjb25zdCBhZGRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgIGFkZEJ1dHRvbi5pbm5lckhUTUwgPSBcImFkZFwiXG5cbiAgICAvL0RPTSBmb3IgYWRkaW5nIHRhc2tzIG9wdGlvbnMgaW50byBhIGRpdlxuICAgIGNvbnN0IHRhc2tPcHRpb25zRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICB0YXNrT3B0aW9uc0Rpdi5jbGFzc0xpc3QuYWRkKFwidGFza09wdGlvbnNcIikgICAgICBcblxuICAgIGNvbnNvbGUubG9nKFwiaW4gdGFza3NcIilcbiAgICBjb25zb2xlLmxvZyhjcmVhdGVOZXdQcm9qZWN0KVxuICAgICAgICBcbiAgICAvL1Rhc2tzIGJlaW5nIGFkZGVkIHRvIGFycmF5XG4gICAgYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKT0+e1xuICAgICAgICBjb25zdCB0YXNrVmFsdWUgPSBhZGRUYXNrRm9ybS52YWx1ZTtcbiAgICAgICAgY29uc3QgcHJpb1ZhbHVlID0gYWRkUHJpb0Zvcm0udmFsdWU7XG4gICAgICAgIGNvbnN0IGR1ZURhdGVWYWx1ZSA9IGFkZFRhc2tEdWVEYXRlRm9ybS52YWx1ZTtcblxuICAgICAgICBsZXQgaXNUYXNrQ29tcGxldGVkID0gZmFsc2U7XG5cbiAgICAgICAgaWYodGFza1ZhbHVlPT1cIlwifHxwcmlvVmFsdWU9PVwiXCJ8fGR1ZURhdGVWYWx1ZT09XCJcIil7XG4gICAgICAgIHJldHVybiBhbGVydChcIkZpbGwgb3V0IGFsbCB0aGUgZmllbGRzXCIpXG4gICAgICAgIH1cbiAgICBcbiAgICAgICAgIGNyZWF0ZU5ld1Byb2plY3QuYWRkVGFzayh7IFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHRhc2tWYWx1ZSxcbiAgICAgICAgICAgIHByaW9yaXR5OiBwcmlvVmFsdWUsXG4gICAgICAgICAgICBkdWVEYXRlOiBkdWVEYXRlVmFsdWUsXG4gICAgICAgICAgICBjb21wbGV0ZWQ6aXNUYXNrQ29tcGxldGVkLFxuICAgICAgICAgICAgaWQ6IGRhdGFDb3VudGVyKyssXG4gICAgICAgIH0pO1xuICAgICAgICB0YXNrQ291bnRlcisrO1xuICAgICAgICBzdG9yZVRhc2tzKGNyZWF0ZU5ld1Byb2plY3QudGFzaywgY3JlYXRlTmV3UHJvamVjdCk7XG5cbiAgICAgICAgLy9ET00gZm9yIGRpc3BsYXlpbmcgdGFza3NcbiAgICAgICAgY29uc3QgY3VycmVudFRhc2tzRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgY3VycmVudFRhc2tzRGl2LmNsYXNzTGlzdC5hZGQoXCJjdXJyZW50VGFza3NcIik7XG4gICAgICAgIGN1cnJlbnRUYXNrc0Rpdi5zZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIsIHRhc2tDb3VudGVyIC0xKTtcbiAgICAgICAgICAgIFxuICAgICAgICBhZGRUYXNrRm9ybS52YWx1ZSA9IFwiXCI7XG4gICAgICAgIGNvbnNvbGUubG9nKGNyZWF0ZU5ld1Byb2plY3QpO1xuXG4gICAgICAgIGNvbnN0IGdldFRhc2tEaXZJZCA9IGN1cnJlbnRUYXNrc0Rpdi5kYXRhc2V0LmlkO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKGdldFRhc2tEaXZJZCArIFwiZm9yIGN1cnJlbnR0YXNrRGl2XCIpXG4gICAgICAgIGN1cnJlbnRUYXNrc0Rpdi5pbm5lckhUTUwgPSBcbiAgICAgICAgICAgIGBUYXNrIG5hbWU6ICR7Y3JlYXRlTmV3UHJvamVjdC5nZXREZXNjcmlwdGlvbigpW2NyZWF0ZU5ld1Byb2plY3QudGFzay5sZW5ndGggLTFdfSxcbiAgICAgICAgICAgICBwcmlvcml0eTogJHtjcmVhdGVOZXdQcm9qZWN0LmdldFByaW8oKVtjcmVhdGVOZXdQcm9qZWN0LnRhc2subGVuZ3RoIC0xXX0sXG4gICAgICAgICAgICAgaXQgaXMgZHVlIHRpbGwgJHtjcmVhdGVOZXdQcm9qZWN0LmdldER1ZURhdGUoKVtjcmVhdGVOZXdQcm9qZWN0LnRhc2subGVuZ3RoIC0xXX1gO1xuXG4gICAgICAgIGNvbnN0IGNvbXBsZXRlQnV0dG9uID0gYWRkQ29tcGxldGVCdXR0b24oY3JlYXRlTmV3UHJvamVjdCwgZ2V0VGFza0RpdklkLCBjdXJyZW50VGFza3NEaXYsIGlzVGFza0NvbXBsZXRlZCk7XG5cbiAgICAgICAgY29uc3QgZGVsZXRlQnV0dG9uID0gYWRkRGVsZXRlQnV0dG9uKGNyZWF0ZU5ld1Byb2plY3QsIGdldFRhc2tEaXZJZCwgY3VycmVudFRhc2tzRGl2LCB0YXNrRGl2KVxuXG4gICAgICAgIGNvbnN0IGVkaXRCdXR0b24gPSBhZGRFZGl0QnV0dG9uKGNyZWF0ZU5ld1Byb2plY3QsIGdldFRhc2tEaXZJZCwgY3VycmVudFRhc2tzRGl2LCBpc1Rhc2tDb21wbGV0ZWQsIHRhc2tEaXYpO1xuXG4gICAgICAgIHRhc2tEaXYuYXBwZW5kQ2hpbGQoY3VycmVudFRhc2tzRGl2KTtcbiAgICAgICAgY3VycmVudFRhc2tzRGl2LmFwcGVuZENoaWxkKGNvbXBsZXRlQnV0dG9uKTtcbiAgICAgICAgY3VycmVudFRhc2tzRGl2LmFwcGVuZENoaWxkKGVkaXRCdXR0b24pO1xuICAgICAgICBjdXJyZW50VGFza3NEaXYuYXBwZW5kQ2hpbGQoZGVsZXRlQnV0dG9uKTtcbn0pXG4gXG4gICAgdGFza09wdGlvbnNEaXYuYXBwZW5kQ2hpbGQoYWRkTGFiZWwpO1xuICAgIHRhc2tPcHRpb25zRGl2LmFwcGVuZENoaWxkKGFkZFRhc2tGb3JtKTtcbiAgICB0YXNrT3B0aW9uc0Rpdi5hcHBlbmRDaGlsZChhZGRMYWJlbFByaW8pO1xuICAgIHRhc2tPcHRpb25zRGl2LmFwcGVuZENoaWxkKGFkZFByaW9Gb3JtKTtcbiAgICB0YXNrT3B0aW9uc0Rpdi5hcHBlbmRDaGlsZChhZGRUYXNrRHVlRGF0ZUxhYmVsKTtcbiAgICB0YXNrT3B0aW9uc0Rpdi5hcHBlbmRDaGlsZChhZGRUYXNrRHVlRGF0ZUZvcm0pO1xuICAgIHRhc2tPcHRpb25zRGl2LmFwcGVuZENoaWxkKGFkZEJ1dHRvbik7XG4gICAgdGFza0Rpdi5hcHBlbmRDaGlsZCh0YXNrT3B0aW9uc0Rpdik7XG5cbiAgICByZXR1cm4gdGFza0Rpdjtcbn0iLCJleHBvcnQgZnVuY3Rpb24gZGlzcGxheVByb2plY3RGcm9tU3RvcmFnZSh0aGVOYW1lSXMpe1xuICAgIGxldCBleGlzdGluZ1Byb2plY3RzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIlByb2plY3RzXCIpKSB8fCBbXTtcblxuICAgIGlmIChleGlzdGluZ1Byb2plY3RzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBleGlzdGluZ1Byb2plY3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgcHJvamVjdCBuYW1lIG1hdGNoZXMgdGhlIHByb3ZpZGVkIG5hbWVcbiAgICAgICAgICAgIGlmIChleGlzdGluZ1Byb2plY3RzW2ldLnByb2plY3ROYW1lID09PSB0aGVOYW1lSXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhlTmFtZUlzOyAvLyBSZXR1cm4gdGhlIHByb3ZpZGVkIG5hbWUgaWYgZm91bmRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHRoZSBwcm92aWRlZCBuYW1lIGlzIG5vdCBmb3VuZCwgcmV0dXJuIHRoZSBuYW1lIG9mIHRoZSBsYXN0IHByb2plY3RcbiAgICAgICAgcmV0dXJuIGV4aXN0aW5nUHJvamVjdHNbZXhpc3RpbmdQcm9qZWN0cy5sZW5ndGggLSAxXS5wcm9qZWN0TmFtZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdGhlTmFtZUlzO1xuICAgIH1cbn0iLCJpbXBvcnQgeyBQcm9qZWN0IH0gZnJvbSBcIi4vY29uc3RydWN0b3JcIjtcbmltcG9ydCB7IGNyZWF0ZVRhc2sgfSBmcm9tIFwiLi90YXNrc1wiO1xuaW1wb3J0IHsgc3RvcmVQcm9qZWN0LCBkZWxldGVQcm9qZWN0LCB1cGRhdGVQcm9qZWN0TmFtZSwgZ2V0UHJvamVjdHNGcm9tU3RvcmFnZSwgc2V0RGVmYXVsdFByb2plY3R9IGZyb20gXCIuL3N0b3JhZ2VcIjtcbmltcG9ydCB7IGRpc3BsYXlQcm9qZWN0RnJvbVN0b3JhZ2UgfSBmcm9tIFwiLi9kaXNwbGF5XCI7XG5pbXBvcnQgeyBhZGRDb21wbGV0ZUJ1dHRvbiwgYWRkRGVsZXRlQnV0dG9uLCBhZGRFZGl0QnV0dG9uIH0gZnJvbSBcIi4vYnV0dG9uc1wiO1xuXG5jb25zdCBjb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb250ZW50XCIpO1xuY29uc3QgcHJvamVjdE5hbWVGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9qZWN0TmFtZVwiKTtcbmNvbnN0IHN1YkJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic3VibWl0XCIpO1xuXG5cbndpbmRvdy5vbmxvYWQgPSAgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IHN0b3JlZFByb2plY3RzID0gIGdldFByb2plY3RzRnJvbVN0b3JhZ2UoKTtcblxuICAgIGxldCBkZWZhdWx0UHJvamVjdCA9IG5ldyBQcm9qZWN0KFwiRGVmYXVsdFwiKVxuICAgIHNldERlZmF1bHRQcm9qZWN0KGRlZmF1bHRQcm9qZWN0KTtcblxuICAgIHN0b3JlZFByb2plY3RzLmZvckVhY2goKHN0b3JlZFByb2plY3QpID0+IHtcbiAgICAgICAgY29uc3QgcHJvamVjdEluc3RhbmNlID0gbmV3IFByb2plY3Qoc3RvcmVkUHJvamVjdC5wcm9qZWN0TmFtZSk7XG5cbiAgICAgICAgc3RvcmVkUHJvamVjdC50YXNrLmZvckVhY2goKHRhc2spPT57XG4gICAgICAgICAgICBwcm9qZWN0SW5zdGFuY2UuYWRkVGFzayh7XG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHRhc2suZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgcHJpb3JpdHk6IHRhc2sucHJpb3JpdHksXG4gICAgICAgICAgICAgICAgZHVlRGF0ZTogdGFzay5kdWVEYXRlLFxuICAgICAgICAgICAgICAgIGNvbXBsZXRlZDogdGFzay5jb21wbGV0ZWQsXG4gICAgICAgICAgICAgICAgaWQ6IHRhc2suaWQgKzEwMCxcbiAgICAgICAgICAgIH0pICAgXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zb2xlLmxvZyhcImFmdGVyIHRhc2tzXCIpXG4gICAgICAgIGNvbnNvbGUubG9nKHByb2plY3RJbnN0YW5jZSlcbiAgICAgICAgZGlzcGxheVByb2plY3QocHJvamVjdEluc3RhbmNlKTtcblxuICAgIH0pO1xufVxuXG5zdWJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpPT57XG4gICAgLy9ET00gZm9yIGFkZGluZyBwcm9qZWN0c1xuICAgIGNvbnN0IHByb2plY3ROYW1lRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBwcm9qZWN0TmFtZURpdi5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcInByb2plY3ROYW1lRGl2XCIpO1xuICAgIGNvbnN0IHByb2plY3RIZWFkbGluZURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHByb2plY3RIZWFkbGluZURpdi5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcInByb2plY3RIZWFkbGluZVwiKTtcbiAgICBjb25zdCBwcm9qZWN0SDMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaDNcIik7XG4gICAgbGV0IHRoZU5hbWVJcyA9IHByb2plY3ROYW1lRm9ybS52YWx1ZTtcbiAgICBsZXQgY3JlYXRlTmV3UHJvamVjdCA9IG5ldyBQcm9qZWN0KHRoZU5hbWVJcyk7XG5cbiAgICBpZihzdG9yZVByb2plY3QoY3JlYXRlTmV3UHJvamVjdCkgPT09ZmFsc2UgKXtcbiAgICAgICAgY29udGVudC5hcHBlbmRDaGlsZChwcm9qZWN0TmFtZURpdik7XG4gICAgICAgIGxldCBleGlzdGluZ1Byb2plY3RzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIlByb2plY3RzXCIpKSB8fCBbXTsgICAgICAgIFxuICAgIH07XG5cbiAgICBwcm9qZWN0SDMuaW5uZXJIVE1MID0gYFByb2plY3QgbmFtZTogYCArIGRpc3BsYXlQcm9qZWN0RnJvbVN0b3JhZ2UodGhlTmFtZUlzKTtcblxuICAgIGNvbnN0IHRhc2tEaXYgPSBjcmVhdGVUYXNrKGNyZWF0ZU5ld1Byb2plY3QpO1xuXG4gICAgY29uc3QgcmVtb3ZlUHJvamVjdEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgcmVtb3ZlUHJvamVjdEJ0bi5pbm5lckhUTUwgPSBcIkRlbGV0ZSBQcm9qZWN0XCI7ICAgXG5cbiAgICBjb25zdCBlZGl0UHJvamVjdEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgZWRpdFByb2plY3RCdG4uaW5uZXJIVE1MID0gXCJFZGl0IFByb2plY3RcIjtcblxuICAgIHByb2plY3ROYW1lRGl2LmFwcGVuZENoaWxkKHByb2plY3RIZWFkbGluZURpdik7XG4gICAgcHJvamVjdEhlYWRsaW5lRGl2LmFwcGVuZENoaWxkKHByb2plY3RIMylcbiAgICBwcm9qZWN0SGVhZGxpbmVEaXYuYXBwZW5kQ2hpbGQocmVtb3ZlUHJvamVjdEJ0bik7XG4gICAgcHJvamVjdEhlYWRsaW5lRGl2LmFwcGVuZENoaWxkKGVkaXRQcm9qZWN0QnRuKTtcbiAgICBwcm9qZWN0TmFtZURpdi5hcHBlbmRDaGlsZCh0YXNrRGl2KTtcblxuICAgIHJlbW92ZVByb2plY3RCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsKCk9PntcbiAgICAgICAgY29udGVudC5yZW1vdmVDaGlsZChwcm9qZWN0TmFtZURpdik7XG4gICAgICAgIGRlbGV0ZVByb2plY3QoY3JlYXRlTmV3UHJvamVjdClcbiAgICB9KVxuXG4gICAgZWRpdFByb2plY3RCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpPT57XG4gICAgICAgIGxldCBuZXdOYW1lSXMgPSBwcm9tcHQoXCJlbnRlciBuZXcgcHJvamVjdCBuYW1lOlwiKTtcbiAgICAgICAgdXBkYXRlUHJvamVjdE5hbWUoY3JlYXRlTmV3UHJvamVjdCwgbmV3TmFtZUlzKVxuICAgICAgICBjb25zb2xlLmxvZyhuZXdOYW1lSXMpO1xuICAgICAgICB0aGVOYW1lSXMgPSBuZXdOYW1lSXM7XG4gICAgICAgIGNyZWF0ZU5ld1Byb2plY3QucHJvamVjdE5hbWUgPSB0aGVOYW1lSXM7XG5cbiAgICAgICAgcHJvamVjdEgzLmlubmVySFRNTCA9IGBQcm9qZWN0IG5hbWUgaXM6ICR7dGhlTmFtZUlzfWA7XG4gICAgICAgIHByb2plY3RIMy5hcHBlbmRDaGlsZChyZW1vdmVQcm9qZWN0QnRuKTtcbiAgICAgICAgcHJvamVjdEgzLmFwcGVuZENoaWxkKGVkaXRQcm9qZWN0QnRuKTtcbiAgICB9KSAgIFxuICAgIHByb2plY3ROYW1lRm9ybS52YWx1ZSA9IFwiXCI7XG4gICAgY29uc29sZS5sb2coY3JlYXRlTmV3UHJvamVjdCk7XG59KTtcblxuXG5cbmZ1bmN0aW9uIGRpc3BsYXlQcm9qZWN0KHByb2plY3RJbnN0YW5jZSkge1xuICAgIGNvbnNvbGUubG9nKFwiaGVyZVwiKVxuICAgIGNvbnNvbGUubG9nKHByb2plY3RJbnN0YW5jZSlcbiAgICBjb25zdCBwcm9qZWN0TmFtZURpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgcHJvamVjdE5hbWVEaXYuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJwcm9qZWN0TmFtZURpdlwiKTtcbiAgICBjb25zdCBwcm9qZWN0SGVhZGxpbmVEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBwcm9qZWN0SGVhZGxpbmVEaXYuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJwcm9qZWN0SGVhZGxpbmVcIik7XG4gICAgY29uc3QgcHJvamVjdEgzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImgzXCIpO1xuXG4gICAgLy8gRGlzcGxheSBwcm9qZWN0IG5hbWUgZnJvbSBzdG9yYWdlXG4gICAgcHJvamVjdEgzLmlubmVySFRNTCA9IGBQcm9qZWN0IG5hbWU6ICR7ZGlzcGxheVByb2plY3RGcm9tU3RvcmFnZShwcm9qZWN0SW5zdGFuY2UucHJvamVjdE5hbWUpfWA7XG5cbiAgICBjb25zdCB0YXNrRGl2ID0gY3JlYXRlVGFzayhwcm9qZWN0SW5zdGFuY2UpO1xuXG4gICAgY29uc3QgcmVtb3ZlUHJvamVjdEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgcmVtb3ZlUHJvamVjdEJ0bi5pbm5lckhUTUwgPSBcIkRlbGV0ZSBQcm9qZWN0XCI7XG5cbiAgICBjb25zdCBlZGl0UHJvamVjdEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgZWRpdFByb2plY3RCdG4uaW5uZXJIVE1MID0gXCJFZGl0IFByb2plY3RcIjtcblxuICAgIHByb2plY3ROYW1lRGl2LmFwcGVuZENoaWxkKHByb2plY3RIZWFkbGluZURpdik7XG4gICAgcHJvamVjdEhlYWRsaW5lRGl2LmFwcGVuZENoaWxkKHByb2plY3RIMyk7XG4gICAgcHJvamVjdEhlYWRsaW5lRGl2LmFwcGVuZENoaWxkKHJlbW92ZVByb2plY3RCdG4pO1xuICAgIHByb2plY3RIZWFkbGluZURpdi5hcHBlbmRDaGlsZChlZGl0UHJvamVjdEJ0bik7XG4gICAgcHJvamVjdE5hbWVEaXYuYXBwZW5kQ2hpbGQodGFza0Rpdik7XG5cbiAgICBwcm9qZWN0SW5zdGFuY2UudGFzay5mb3JFYWNoKCh0YXNrKSA9PiB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRUYXNrc0RpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIGN1cnJlbnRUYXNrc0Rpdi5jbGFzc0xpc3QuYWRkKFwiY3VycmVudFRhc2tzXCIpO1xuICAgICAgICBjdXJyZW50VGFza3NEaXYuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLCB0YXNrLmlkKTtcbiAgICAgICAgY29uc3QgZ2V0VGFza0RpdklkID0gY3VycmVudFRhc2tzRGl2LmRhdGFzZXQuaWQ7XG4gICAgICAgIGNvbnN0IGlzVGFza0NvbXBsZXRlZCA9IHRhc2suY29tcGxldGVkO1xuXG4gICAgICAgIGlmKGlzVGFza0NvbXBsZXRlZCA9PT0gdHJ1ZSl7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygneWVhIHRoaXMgaXMgZG9uZScpXG4gICAgICAgICAgICBjdXJyZW50VGFza3NEaXYuY2xhc3NMaXN0LmFkZChcImNvbXBsZXRlXCIpXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGN1cnJlbnRUYXNrc0Rpdi5pbm5lckhUTUwgPSBgXG4gICAgICAgICAgICBUYXNrIG5hbWU6ICR7dGFzay5kZXNjcmlwdGlvbn0sXG4gICAgICAgICAgICBwcmlvcml0eTogJHt0YXNrLnByaW9yaXR5fSxcbiAgICAgICAgICAgIGl0IGlzIGR1ZSB0aWxsICR7dGFzay5kdWVEYXRlfWA7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgIGNvbnN0IGNvbXBsZXRlQnV0dG9uID0gYWRkQ29tcGxldGVCdXR0b24ocHJvamVjdEluc3RhbmNlLGdldFRhc2tEaXZJZCwgY3VycmVudFRhc2tzRGl2KTtcbiAgICAgICAgY29uc3QgZGVsZXRlQnV0dG9uID0gYWRkRGVsZXRlQnV0dG9uKHByb2plY3RJbnN0YW5jZSwgZ2V0VGFza0RpdklkLCBjdXJyZW50VGFza3NEaXYsIHRhc2tEaXYpO1xuICAgICAgICBjb25zdCBlZGl0QnV0dG9uID0gYWRkRWRpdEJ1dHRvbihwcm9qZWN0SW5zdGFuY2UsIGdldFRhc2tEaXZJZCwgY3VycmVudFRhc2tzRGl2LCBpc1Rhc2tDb21wbGV0ZWQsIHRhc2tEaXYpO1xuXG4gICAgICAgIHRhc2tEaXYuYXBwZW5kQ2hpbGQoY3VycmVudFRhc2tzRGl2KTtcbiAgICAgICAgY3VycmVudFRhc2tzRGl2LmFwcGVuZENoaWxkKGNvbXBsZXRlQnV0dG9uKTtcbiAgICAgICAgY3VycmVudFRhc2tzRGl2LmFwcGVuZENoaWxkKGVkaXRCdXR0b24pO1xuICAgICAgICBjdXJyZW50VGFza3NEaXYuYXBwZW5kQ2hpbGQoZGVsZXRlQnV0dG9uKTtcbiAgICB9KTtcblxuICAgIHJlbW92ZVByb2plY3RCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgY29udGVudC5yZW1vdmVDaGlsZChwcm9qZWN0TmFtZURpdik7XG4gICAgICAgIGRlbGV0ZVByb2plY3QocHJvamVjdEluc3RhbmNlKTtcbiAgICB9KTtcblxuICAgIGVkaXRQcm9qZWN0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIGxldCBuZXdOYW1lSXMgPSBwcm9tcHQoXCJFbnRlciBuZXcgcHJvamVjdCBuYW1lOlwiKTtcbiAgICAgICAgdXBkYXRlUHJvamVjdE5hbWUocHJvamVjdEluc3RhbmNlLCBuZXdOYW1lSXMpO1xuXG4gICAgICAgIC8vIFVwZGF0ZSB0aGUgZGlzcGxheWVkIHByb2plY3QgbmFtZVxuICAgICAgICBwcm9qZWN0SDMuaW5uZXJIVE1MID0gYFByb2plY3QgbmFtZTogJHtkaXNwbGF5UHJvamVjdEZyb21TdG9yYWdlKG5ld05hbWVJcyl9YDtcbiAgICB9KTtcbiAgICBjb250ZW50LmFwcGVuZENoaWxkKHByb2plY3ROYW1lRGl2KTtcbn1cblxuXG5cbiJdLCJuYW1lcyI6WyJQcm9qZWN0IiwiY29uc3RydWN0b3IiLCJwcm9qZWN0TmFtZSIsInRoaXMiLCJ0YXNrIiwiYWRkVGFzayIsIm5ld1Rhc2siLCJwdXNoIiwiZGlzcGxheVRhc2siLCJpbmRleCIsImNvbnNvbGUiLCJsb2ciLCJnZXREZXNjcmlwdGlvbiIsIm1hcCIsImRlc2NyaXB0aW9uIiwiZ2V0UHJpbyIsInByaW9yaXR5IiwiZ2V0RHVlRGF0ZSIsImR1ZURhdGUiLCJnZXRJRCIsImlkIiwiZ2V0UHJvamVjdHNGcm9tU3RvcmFnZSIsInN0b3JlZFByb2plY3RzIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsIkpTT04iLCJwYXJzZSIsImRlbGV0ZVByb2plY3QiLCJwcm9qZWN0VG9EZWxldGUiLCJleGlzdGluZ1Byb2plY3RzIiwic3RyaW5naWZ5IiwibGVuZ3RoIiwiaSIsInNwbGljZSIsInNldEl0ZW0iLCJ1cGRhdGVQcm9qZWN0TmFtZSIsInByb2plY3RUb0VkaXQiLCJuZXdOYW1lSXMiLCJkZWxldGVUYXNrIiwidGFza1RvRGVsZXRlIiwiaW5kZXhUb0RlbGV0ZSIsImZpbmRJbmRleCIsInVwZGF0ZVRhc2tOYW1lIiwidGFza1RvVXBkYXRlIiwibmV3TmFtZSIsImoiLCJtYXJrQXNDb21wbGV0ZWQiLCJ2YWx1ZSIsImN1cnJlbnRUYXNrc0RpdiIsImNvbXBsZXRlZCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsImFkZENvbXBsZXRlQnV0dG9uIiwiY3JlYXRlTmV3UHJvamVjdCIsImdldFRhc2tEaXZJZCIsImlzVGFza0NvbXBsZXRlZCIsImNvbXBsZXRlQnV0dG9uIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwiYWRkRXZlbnRMaXN0ZW5lciIsImFkZERlbGV0ZUJ1dHRvbiIsInRhc2tEaXYiLCJkZWxldGVUYXNrQnV0dG9uIiwicmVtb3ZlQ2hpbGQiLCJhZGRFZGl0QnV0dG9uIiwiZWRpdFRhc2tCdXR0b24iLCJlZGl0VGFza05hbWUiLCJwcm9tcHQiLCJhcHBlbmRDaGlsZCIsImNyZWF0ZVRhc2siLCJkYXRhQ291bnRlciIsInRhc2tDb3VudGVyIiwiYWRkVGFza0Zvcm0iLCJzZXRBdHRyaWJ1dGUiLCJhZGRMYWJlbCIsImFkZFByaW9Gb3JtIiwib3B0aW9uc0hpZ2giLCJvcHRpb25zVGV4dEhpZ2giLCJjcmVhdGVUZXh0Tm9kZSIsIm9wdGlvbnNNZWQiLCJvcHRpb25zVGV4dE1lZCIsIm9wdGlvbnNMb3ciLCJvcHRpb25zVGV4dExvdyIsImFkZExhYmVsUHJpbyIsImFkZFRhc2tEdWVEYXRlRm9ybSIsImFkZFRhc2tEdWVEYXRlTGFiZWwiLCJhZGRCdXR0b24iLCJ0YXNrT3B0aW9uc0RpdiIsInRhc2tWYWx1ZSIsInByaW9WYWx1ZSIsImR1ZURhdGVWYWx1ZSIsImFsZXJ0Iiwic3RvcmVUYXNrIiwic3RvcmVUYXNrcyIsImRhdGFzZXQiLCJkZWxldGVCdXR0b24iLCJlZGl0QnV0dG9uIiwiZGlzcGxheVByb2plY3RGcm9tU3RvcmFnZSIsInRoZU5hbWVJcyIsImNvbnRlbnQiLCJnZXRFbGVtZW50QnlJZCIsInByb2plY3ROYW1lRm9ybSIsInN1YkJ1dHRvbiIsIndpbmRvdyIsIm9ubG9hZCIsImRlZmF1bHRQcm9qZWN0Iiwic2V0RGVmYXVsdFByb2plY3QiLCJmb3JFYWNoIiwic3RvcmVkUHJvamVjdCIsInByb2plY3RJbnN0YW5jZSIsInByb2plY3ROYW1lRGl2IiwicHJvamVjdEhlYWRsaW5lRGl2IiwicHJvamVjdEgzIiwicmVtb3ZlUHJvamVjdEJ0biIsImVkaXRQcm9qZWN0QnRuIiwiZGlzcGxheVByb2plY3QiLCJwcm9qZWN0IiwiZmluZCIsInByb2plY3RPYmoiLCJzdG9yZVByb2plY3QiXSwic291cmNlUm9vdCI6IiJ9